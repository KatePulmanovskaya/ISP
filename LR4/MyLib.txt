using System.Collections.Generic;
using System.Diagnostics;
using System.Management;

namespace MyLib
{
    public class Processes
    {
        public void GetInfo()
        {
            //ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_Process");
            //foreach (ManagementObject obj in searcher.Get())
            //{
            //    Console.WriteLine(obj["Name"].ToString());
            //}
            foreach (Process process in Process.GetProcesses())
            {
                Console.WriteLine($"ID: {process.Id}  Name: {process.ProcessName} Memory(bytes): {process.VirtualMemorySize64}");
            }
        }

        public void KillProcess(int ID)
        {
            foreach (Process process in Process.GetProcesses())
            {
                if (process.Id == ID)
                    process.Kill();
            }
        }

        public void KillProcess(string name)
        {
            foreach (Process process in Process.GetProcesses())
            {
                if (process.ProcessName == name)
                    process.Kill();
            }
        }
    }
}